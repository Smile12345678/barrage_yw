const Fs=require("fire-fs");let CfgUtil=Editor.require("packages://bitmap-font/core/CfgUtil");const Msg=Editor.require("packages://bitmap-font/panel/msg.js");module.exports=Vue.component("char-item",{props:["data","index","chars"],template:Fs.readFileSync(Editor.url("packages://bitmap-font/panel/item/item.html"),"utf8"),data:()=>({}),created(){this.$nextTick(()=>{this.onMouseOut()}),this.$root.$on("OnDropChars",()=>{})},computed:{charBgColor(){let t=this.data.char;return void 0===t||null===t||""===t?"#ff342e":this.checkIsContentRepeatChar(t)?"#ff342e":null}},methods:{_createRightMenu(t){const e=require("electron").remote,n=e.Menu,a=e.MenuItem;let o=new n;for(let e=0;e<t.length;e++)o.append(new a(t[e]));let r=e.getCurrentWindow();o.popup(r)},onMenu(t){let e=[{label:"删除",click:()=>{this.onClickBtnDel()}},{type:"separator"},{label:"删除全部",click(){Editor.Ipc.sendToPanel("bitmap-font","onClickDelAllChar",this.data)}}];this._createRightMenu(e)},onMouseOver(){this.$el.style.backgroundColor="#666"},onMouseOut(){this.$el.style.backgroundColor=this.index%2?"#555":"#444"},checkIsContentRepeatChar(t){let e=JSON.parse(JSON.stringify(this.chars)),n=[];for(let a=0;a<e.length;a++){let o=e[a];o.char===t&&n.push(o)}if(n.length>1){let e=`发现多张图片对应同一个字符[${t}] :\n`;for(let t=0;t<n.length;t++)e+=n[t].image+"\n";return Editor.Ipc.sendToPanel("bitmap-font","onLog",`字符(${this.data.char})设置重复:${this.data.image}`),!0}return!1},onInputChar(){let t=this.data.char;null!==t&&void 0!==t||(t=""),t.length>1&&(t=t[0]),this.data.char=t,CfgUtil.saveConfig()},onClickBtnDel(t){Editor.Ipc.sendToPanel("bitmap-font","onClickDelChar",this.data)}}});